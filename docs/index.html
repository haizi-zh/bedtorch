<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R package for fast BED-file manipulation • bedtorch</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="R package for fast BED-file manipulation">
<meta property="og:description" content="This package provides tools to read and write BED/BEDGRAPH files.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">bedtorch</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="bedtorch" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#bedtorch" class="anchor"></a>bedtorch</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<div id="motivation" class="section level2">
<h2 class="hasAnchor">
<a href="#motivation" class="anchor"></a>Motivation</h2>
<p>The goal of bedtorch is to provide a fast and native toolsuite for BED file manipulation.</p>
<p>In bioinformatics studies, an important type of jobs is related to BED and BED-like file manipulation. For example, filtering cfDNA fragments based on length, identifying genomic regions overlapping with certain genes, filtering features based on epigenetic profiles such as histone modification levels, finding out SNVs in a certain genomic interval, etc.</p>
<p>In shell, many of such tasks can be done by some highly-optimized tools, such as bedtools and bedops. However, sometimes people wants to achieve this in R environment, not by some external command line tools. This is especially true when people are developing their methods in R.</p>
<p>R’s native <code>data.frame</code> type seems to be a good model for BED-like data, but in many scenarios it’s peformance is poor, and more importantly, it lacks many advanced features compared with <code>dplyr</code> and <code>data.table</code>. Another choice is using <code>bedr</code>, which is bridge linking R codes and bedtools together. However, this workflow requires lots of disk IO, since data frames in R needs to be written to temporary folders before being fed to bedtools. To make things even worse, output from bedtools are captured and transferred back to R session’s space via <code>system2</code>. This can be extremely slow when the dataset’s size is large. Moreover, data transferred back to R will lose any information about data type, index (in the case of <code>data.table</code>), column names, etc. Users are on their own to rebuild the data frame (<code>tibble</code> or <code>data.table</code>), and reset data type, column names, etc. This can be very tedious, error-prone and slow (for rebuilding index). Therefore, it would be helpful if there is a R package providing these functionalities natively.</p>
<p>bedtorch is an attempt for this. Under the hood, every BED dataset is represented as a <code>data.table</code> object. Users can apply various operations on it, such as intersect, merge, etc. Users can also perform any <code>data.table</code> operations as needed.</p>
<p>In terms of the core computation, <code>bedtorch</code>’s performance is comparable to bedtools. However, since no disk IO and data conversion is needed, users can directly manipulate the dataset in memory, therefore in practice, via bedtorch, many tasks can be done about one magnitude faster.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"haizi-zh/bedtorch"</span><span class="op">)</span></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This is a basic example which shows you how to solve a common problem:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">bedtorch</span><span class="op">)</span>

<span class="co">## Load BED data</span>
<span class="va">bedtbl</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="reference/read_bed.html">read_bed</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example2.bed.gz"</span>, package <span class="op">=</span> <span class="st">"bedtorch"</span><span class="op">)</span>,
           range <span class="op">=</span> <span class="st">"1:3001-4000"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bedtbl</span><span class="op">)</span>
<span class="co">#&gt;    chrom start  end score1 score2</span>
<span class="co">#&gt; 1:     1  2925 3011    106    181</span>
<span class="co">#&gt; 2:     1  3003 3092     88    193</span>
<span class="co">#&gt; 3:     1  3091 3193    118    212</span>
<span class="co">#&gt; 4:     1  3164 3248     94    211</span>
<span class="co">#&gt; 5:     1  3232 3345    107    205</span>
<span class="co">#&gt; 6:     1  3300 3395     88    193</span>

<span class="co">## Merge intervals, and take the mean of score in each merged group</span>
<span class="va">merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/merge_bed.html">merge_bed</a></span><span class="op">(</span><span class="va">bedtbl</span>,
                    operation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
                      mean_score <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
                        <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">score1</span><span class="op">)</span>
                    <span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">merged</span><span class="op">)</span>
<span class="co">#&gt;    chrom start  end mean_score</span>
<span class="co">#&gt; 1:     1  2925 4016   99.07143</span>

<span class="co">## Find intersections between two datasets</span>
<span class="va">tbl_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_bed.html">read_bed</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_merge.bed"</span>, package <span class="op">=</span> <span class="st">"bedtorch"</span><span class="op">)</span><span class="op">)</span>
<span class="va">tbl_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_bed.html">read_bed</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_intersect_y.bed"</span>, package <span class="op">=</span> <span class="st">"bedtorch"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="reference/intersect_bed.html">intersect_bed</a></span><span class="op">(</span><span class="va">tbl_x</span>, <span class="va">tbl_y</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    chrom start end score</span>
<span class="co">#&gt; 1:    21    22  25     7</span>
<span class="co">#&gt; 2:    21    26  30     7</span>
<span class="co">#&gt; 3:    21    29  35     9</span>
<span class="co">#&gt; 4:    21    47  49     1</span>
<span class="co">#&gt; 5:    21    47  50     2</span>
<span class="co">#&gt; 6:    21    53  55     5</span></code></pre></div>
</div>
<div id="see-also" class="section level2">
<h2 class="hasAnchor">
<a href="#see-also" class="anchor"></a>See also</h2>
<p>Many features are inspired by bedtools. Thus, it’s helpful to get familiar with bedtool’s documentation: <a href="https://bedtools.readthedocs.io/en/latest/index.html" class="uri">https://bedtools.readthedocs.io/en/latest/index.html</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Haizi Zheng <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-6165-0179" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Haizi Zheng.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
